async function k(o,e,t){const{callbackUrl:n=window.location.href,redirect:a=!0}=e??{},{prefix:s="/api/auth",...l}=e??{},w=o==="credentials",u=`${`${s}/callback/${o}`}?${new URLSearchParams(t)}`,f=await fetch(`${s}/csrf`),{csrfToken:h}=await f.json(),d=await fetch(u,{method:"post",headers:{"Content-Type":"application/x-www-form-urlencoded","X-Auth-Return-Redirect":"1"},body:new URLSearchParams({...l,csrfToken:h,callbackUrl:n})}),r=await d.clone().json(),p=new URL(r.url).searchParams.get("error");if(a||!w||!p){window.location.href=r.url??n,r.url.includes("#")&&window.location.reload();return}return d}async function g(o){const{callbackUrl:e=window.location.href,prefix:t="/api/auth"}={},n=await fetch(`${t}/csrf`),{csrfToken:a}=await n.json(),c=(await(await fetch(`${t}/signout`,{method:"post",headers:{"Content-Type":"application/x-www-form-urlencoded","X-Auth-Return-Redirect":"1"},body:new URLSearchParams({csrfToken:a,callbackUrl:e})})).json()).url??e;window.location.href=c,c.includes("#")&&window.location.reload()}const i=document.getElementById("logged")?.getAttribute("data-value"),m=document.getElementById("btn");m.addEventListener("click",()=>{console.log("click",i),i==="1"&&g(),i==="0"&&document.getElementsByClassName("wrapper")[0].classList.add("present")});export{k as s};
